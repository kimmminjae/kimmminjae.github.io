<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Android Camera2 API Pipeline Manipulation - Min Jae Kim</title>
<meta name="description" content="Let’s Take Some Picture!">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Min Jae Kim">
<meta property="og:title" content="Android Camera2 API Pipeline Manipulation">
<meta property="og:url" content="www.kimmj.com/code/android-camera2-api-pipeline-app/">


  <meta property="og:description" content="Let’s Take Some Picture!">



  <meta property="og:image" content="www.kimmj.com/assets/images/blog/2016-08-27-android-camera2-api-pipeline-app/hero.jpg">





  <meta property="article:published_time" content="2016-08-27T08:00:00+00:00">





  

  


<link rel="canonical" href="www.kimmj.com/code/android-camera2-api-pipeline-app/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Min Jae Kim",
      "url": "www.kimmj.com",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Min Jae Kim Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="shortcut icon" hype="image/png" href="/assets/images/favicon.png">
<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">Min Jae Kim</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li><li class="masthead__menu-item">
              <a href="/files/Resume_Min-Jae-Kim.pdf" >CV</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/" >Blog</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  











<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/assets/images/blog/2016-08-27-android-camera2-api-pipeline-app/hero.jpg');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
            Android Camera2 API Pipeline Manipulation

        
      </h1>
      
        <p class="page__lead">Let’s Take Some Picture!
</p>
      
      
        <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read
</p>
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/bio-photo.jpg" alt="Min Jae Kim" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Min Jae Kim</h3>
    
    
      <p class="author__bio" itemprop="description">
        
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fab fa-fw fa-canadian-maple-leaf" aria-hidden="true"></i> <span itemprop="name">Toronto, ON</span>
        </li>
      

      
        
          
            <li><a href="mailto:hello@kimmj.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/kimmminjae" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin-in" aria-hidden="true"></i> LinkedIn</a></li>
          
        
          
            <li><a href="https://twitter.com/kimmMinJae" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
        
          
            <li><a href="https://github.com/kimmminjae" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
            <li><a href="https://www.instagram.com/kimminjaeee" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      <li style="padding-top: 10px">
          <strong>Certifications</strong>
      </li>
      
        
          
            <li><a href="/files/Sitecore_Min-Jae-Kim.pdf" rel="nofollow noopener noreferrer"><i class="fab fa-stripe-s" aria-hidden="true"></i> Sitecore</a></li>
          
        
          
            <li><a href="/files/Coveo_Min-Jae-Kim.pdf" rel="nofollow noopener noreferrer"><i class="fas fa-copyright" aria-hidden="true"></i> Coveo</a></li>
          
        
       
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Android Camera2 API Pipeline Manipulation">
    <meta itemprop="description" content="Let’s Take Some Picture!">
    <meta itemprop="datePublished" content="August 27, 2016">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
        <h2 id="intro">Intro</h2>

<p>Ever since the birth of digital cameras, the ability to edit its image
processing pipeline has been held exclusively by the camera manufacturers.
Google is trying to change the game with the release of the Camera 2 API for
Android. This new program interface will enable developers to input functions
into the digital imaging pipeline (Figure 1) to customize and edit features.
Just like how we have phones which are 100 million times faster than the Apollo
11’s command module, the digital imaging pipeline can be altered on our phones,
once exclusively done by bulky and expensive hardware!</p>

<p>I made an application which runs a user customizable pipeline based on Hakki Can
Karaimer’s publication[1] (https://karaimer.github.io/camera-pipeline/). The
main objective of this project was to normalize (calibrate) different cameras by
calculating the optimal RGGB Channel Vector. Proprietary pipelines built by
different phone manufacturers often produced different images under identical
scenes, but by calibrating the pipeline, I was able to produce identical images.</p>

<p><img src="/assets/images/blog/2016-08-27-android-camera2-api-pipeline-app/media/7e8d87d13c6ea7c1300e0c6a9c360cb6.png" alt="" /></p>

<p>Figure 1 Karaimer H.C., Brown M.S. (2016) “A Software Platform for Manipulating
the Camera Imaging Pipeline”, European Conference on Computer Vision (ECCV`16),
Oct 2016 (https://karaimer.github.io/camera-pipeline/)</p>

<h2 id="digital-imaging-pipeline">Digital Imaging Pipeline</h2>

<p>As represented in Figure 1, the Digital Imaging Pipeline is split into 12
different steps; each step represents a function applied to the RAW image. I
focused on step 1, 2, 4, and 6 for my app.</p>

<h3 id="reading-raw-image">Reading Raw Image</h3>

<p>After raw data is taken in by the camera sensor, the electronic signals are
converted into a grayscale image with a Bayer pattern.</p>

<h3 id="black-light-subtraction">Black Light Subtraction</h3>

<p>Black light subtraction is a method of brightening an image by reducing the
intensity of the black level. A black level is defined as the level of
brightness at the darkest part of the image.</p>

<h3 id="demosaicing">Demosaicing</h3>

<p>Usually, in the form of Red Green Green Blue, the Bayer pattern must go through
a process called demosaicing before being processed further. This is represented
by Stage 4 of the pipeline and requires the green pixels in a four by four
matrix to be measured and averaged out.</p>

<p>I used OpenCV to accomplish this.</p>

<p><img src="/assets/images/blog/2016-08-27-android-camera2-api-pipeline-app/media/dcdf0db1069713d9022b811534a3d21d.png" alt="" /></p>

<p>Figure 2 Use this image to show demosaicing <a href="http://www.ok.sc.e.titech.ac.jp/\~ymonno/researches.html">http://www.ok.sc.e.titech.ac.jp/~ymonno/researches.html</a></p>

<h3 id="white-balancing">White Balancing</h3>

<p>The user selects the white area and the app calculates the RGGB Vector value
required to make the selected region white. This value is applied to the entire
RAW image to white balance. This process forces the selected region to have
identical Red, Green, and Blue pixels values.</p>

<p><img src="/assets/images/blog/2016-08-27-android-camera2-api-pipeline-app/media/7c5c7e3f3d7b851ddde7ec1d0bc2b756.png" alt="" /></p>

<p>Figure 3 Raw Image with gamma correction (Left/Stage 1), Black Light
Substraction (Middle/Stage 2), White Balance (Right/Stage 6)</p>

<h3 id="other-abilities">Other Abilities</h3>

<ul>
  <li>
    <p>Auto Focus</p>
  </li>
  <li>
    <p>Manual Focus</p>
  </li>
  <li>
    <p>Preset White Balance Profiles</p>
  </li>
  <li>
    <p>Manual White Balance (User selects white area)</p>
  </li>
  <li>
    <p>Preset Scene Modes</p>
  </li>
  <li>
    <p>Raw capture</p>
  </li>
  <li>
    <p>Manual ISO</p>
  </li>
  <li>
    <p>Manual Shutter Speed</p>
  </li>
  <li>
    <p>Intervalometer (Supports RAW)</p>
  </li>
  <li>
    <p>Manual Colour Transformation Matrix</p>
  </li>
</ul>

<h2 id="applications">Applications</h2>

<p><strong>Computer Vision:</strong> This default process isn’t always preferred for uses in
computer vision or medical imaging. It is particularly important in computer
vision where it is extremely crucial for objects to be recognized, identified,
and properly labelled. An image ran through a typical pipeline can be mildly
useful for computer vision, but with pipeline manipulation, the chances of
recognition are greatly increased. For example, an object that blends in with
the environment can be recognized easier if the Tone Curve Application (Step 10)
of the pipeline can be altered to contrast the differences.</p>

<p><strong>Medical Imaging:</strong> Along the same lines of computer vision, medical imaging
can benefit greatly from pattern recognition. According to “Spectral Response of
Silicon Image Sensors” by Arnaud Darmont April 2009, CMOS sensors typically
found in our phones can actually see higher and lower wavelengths than the human
eyes. By omitting or altering the typical imaging pipeline, we may be able to
use various silicon-sensitive wavelengths to diagnose illnesses.</p>

<p><strong>Aesthetic Photography:</strong> Post-shoot photograph manipulation has been around
for years but unfortunately it has been accessible to very few people. Many
applications nowadays are able to manipulate photos by adding filters or
mechanisms to make them look more appealing or by editing RAW files in
post-shoot. As it turns out, the most popular filters occur naturally in nature
and can be easily found by simply removing or altering a step in the pipeline.
For example, Natural Vignetting; In step 3 of the pipeline, light (or the lack
thereof) is automatically compensated for through lens correction. Due to
smartphones having a low aperture, this step typically adds exposure to the
edges of the photo to match the exposure in the centre. Unknowingly to many of
the people posting Instagram pictures, the vignette does not require post-shoot
alterations, it only needs to be omitted by the pipeline.</p>

<h2 id="acknowledgements">Acknowledgements</h2>

<p>This project would have been impossible without the expert knowledge of Michael
S. Brown, Hakki Can Karaimer, and Abdelrahman Kamel.</p>

<p>I would also like to thank the Lassonde School of Engineering at York University
by letting me present this project at the Lassonde Research Conference with the
Lassonde Undergraduate Research Award.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#android" class="page__taxonomy-item" rel="tag">Android</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#camera" class="page__taxonomy-item" rel="tag">Camera</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#computer-vision" class="page__taxonomy-item" rel="tag">Computer Vision</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#opencv" class="page__taxonomy-item" rel="tag">OpenCV</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#white-balance" class="page__taxonomy-item" rel="tag">White Balance</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#code" class="page__taxonomy-item" rel="tag">code</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-08-27T08:00:00+00:00">August 27, 2016</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Android+Camera2+API+Pipeline+Manipulation%20www.kimmj.com%2Fcode%2Fandroid-camera2-api-pipeline-app%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=www.kimmj.com%2Fcode%2Fandroid-camera2-api-pipeline-app%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=www.kimmj.com%2Fcode%2Fandroid-camera2-api-pipeline-app%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google Plus"><i class="fab fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=www.kimmj.com%2Fcode%2Fandroid-camera2-api-pipeline-app%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="#" class="pagination--pager disabled">Previous</a>
    
    
      <a href="/code/sitecore-hackathon-2019-with-apiqu/" class="pagination--pager" title="Sitecore Hackathon 2019 with Apiqu!
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/code/sitecore-9-0-certification-exam-and-preparation/" rel="permalink">Sitecore 9.0 Certification Exam and Preparation
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">How I became a Sitecore 9.0 Certified Developer!
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/code/sitecore-hackathon-2019-with-apiqu/" rel="permalink">Sitecore Hackathon 2019 with Apiqu!
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Let’s Take Some Picture!
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div> -->

<div class="page__footer-copyright">&copy; 2019 Min Jae Kim.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>







  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-134940390-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






  </body>
</html>
